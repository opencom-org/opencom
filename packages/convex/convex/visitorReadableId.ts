import type { Id } from "./_generated/dataModel";

const HUMAN_ID_ADJECTIVES = [
  "afraid",
  "all",
  "beige",
  "better",
  "big",
  "blue",
  "bold",
  "brave",
  "breezy",
  "bright",
  "brown",
  "bumpy",
  "busy",
  "calm",
  "chatty",
  "chilly",
  "chubby",
  "clean",
  "clear",
  "clever",
  "cold",
  "common",
  "cool",
  "cozy",
  "crisp",
  "cuddly",
  "curly",
  "curvy",
  "cute",
  "cyan",
  "dark",
  "deep",
  "dirty",
  "dry",
  "dull",
  "eager",
  "early",
  "easy",
  "eight",
  "eighty",
  "eleven",
  "empty",
  "every",
  "fair",
  "famous",
  "fancy",
  "fast",
  "few",
  "fiery",
  "fifty",
  "fine",
  "five",
  "flat",
  "floppy",
  "fluffy",
  "forty",
  "four",
  "frank",
  "free",
  "fresh",
  "fruity",
  "full",
  "funky",
  "funny",
  "fuzzy",
  "gentle",
  "giant",
  "gold",
  "good",
  "goofy",
  "great",
  "green",
  "grumpy",
  "happy",
  "heavy",
  "hip",
  "honest",
  "hot",
  "huge",
  "humble",
  "hungry",
  "icy",
  "itchy",
  "jolly",
  "khaki",
  "kind",
  "large",
  "late",
  "lazy",
  "legal",
  "lemon",
  "light",
  "little",
  "long",
  "loose",
  "loud",
  "lovely",
  "lucky",
  "major",
  "many",
  "metal",
  "mighty",
  "modern",
  "moody",
  "neat",
  "new",
  "nice",
  "nine",
  "ninety",
  "odd",
  "old",
  "olive",
  "open",
  "orange",
  "perky",
  "petite",
  "pink",
  "plain",
  "plenty",
  "polite",
  "pretty",
  "proud",
  "public",
  "puny",
  "purple",
  "quick",
  "quiet",
  "rare",
  "ready",
  "real",
  "red",
  "rich",
  "ripe",
  "salty",
  "seven",
  "shaggy",
  "shaky",
  "sharp",
  "shiny",
  "short",
  "shy",
  "silent",
  "silly",
  "silver",
  "six",
  "sixty",
  "slick",
  "slimy",
  "slow",
  "small",
  "smart",
  "smooth",
  "social",
  "soft",
  "solid",
  "some",
  "sour",
  "sparkly",
  "spicy",
  "spotty",
  "stale",
  "strict",
  "strong",
  "sunny",
  "sweet",
  "swift",
  "tall",
  "tame",
  "tangy",
  "tasty",
  "ten",
  "tender",
  "thick",
  "thin",
  "thirty",
  "three",
  "tidy",
  "tiny",
  "tired",
  "tough",
  "tricky",
  "true",
  "twelve",
  "twenty",
  "two",
  "upset",
  "vast",
  "violet",
  "wacky",
  "warm",
  "wet",
  "whole",
  "wicked",
  "wide",
  "wild",
  "wise",
  "witty",
  "yellow",
  "young",
  "yummy",
] as const;

const HUMAN_ID_NOUNS = [
  "actors",
  "ads",
  "adults",
  "aliens",
  "animals",
  "ants",
  "apes",
  "apples",
  "areas",
  "baboons",
  "badgers",
  "bags",
  "balloons",
  "bananas",
  "banks",
  "bars",
  "baths",
  "bats",
  "beans",
  "bears",
  "beds",
  "beers",
  "bees",
  "berries",
  "bikes",
  "birds",
  "boats",
  "bobcats",
  "books",
  "bottles",
  "boxes",
  "breads",
  "brooms",
  "buckets",
  "bugs",
  "buses",
  "bushes",
  "buttons",
  "camels",
  "cameras",
  "candies",
  "candles",
  "canyons",
  "carpets",
  "carrots",
  "cars",
  "cases",
  "cats",
  "chairs",
  "chefs",
  "chicken",
  "cities",
  "clocks",
  "cloths",
  "clouds",
  "clowns",
  "clubs",
  "coats",
  "cobras",
  "coins",
  "colts",
  "comics",
  "cooks",
  "corners",
  "cougars",
  "cows",
  "crabs",
  "crews",
  "cups",
  "cycles",
  "dancers",
  "days",
  "deer",
  "deserts",
  "dingos",
  "dodos",
  "dogs",
  "dolls",
  "donkeys",
  "donuts",
  "doodles",
  "doors",
  "dots",
  "dragons",
  "drinks",
  "dryers",
  "ducks",
  "eagles",
  "ears",
  "eels",
  "eggs",
  "emus",
  "ends",
  "experts",
  "eyes",
  "facts",
  "falcons",
  "fans",
  "feet",
  "files",
  "flies",
  "flowers",
  "forks",
  "foxes",
  "friends",
  "frogs",
  "games",
  "garlics",
  "geckos",
  "geese",
  "ghosts",
  "gifts",
  "glasses",
  "goats",
  "grapes",
  "groups",
  "guests",
  "hairs",
  "hands",
  "hats",
  "heads",
  "hoops",
  "hornets",
  "horses",
  "hotels",
  "hounds",
  "houses",
  "humans",
  "icons",
  "ideas",
  "impalas",
  "insects",
  "islands",
  "items",
  "jars",
  "jeans",
  "jobs",
  "jokes",
  "keys",
  "kids",
  "kings",
  "kiwis",
  "knives",
  "lamps",
  "lands",
  "laws",
  "lemons",
  "lies",
  "lights",
  "lilies",
  "lines",
  "lions",
  "lizards",
  "llamas",
  "loops",
  "mails",
  "mammals",
  "mangos",
  "maps",
  "masks",
  "meals",
  "melons",
  "memes",
  "meteors",
  "mice",
  "mirrors",
  "moles",
  "moments",
  "monkeys",
  "months",
  "moons",
  "moose",
  "mugs",
  "nails",
  "needles",
  "news",
  "nights",
  "numbers",
  "olives",
  "onions",
  "oranges",
  "otters",
  "owls",
  "pandas",
  "pans",
  "pants",
  "papayas",
  "papers",
  "parents",
  "parks",
  "parrots",
  "parts",
  "paths",
  "paws",
  "peaches",
  "pears",
  "peas",
  "pens",
  "pets",
  "phones",
  "pianos",
  "pigs",
  "pillows",
  "places",
  "planes",
  "planets",
  "plants",
  "plums",
  "poems",
  "poets",
  "points",
  "pots",
  "pugs",
  "pumas",
  "queens",
  "rabbits",
  "radios",
  "rats",
  "ravens",
  "readers",
  "regions",
  "results",
  "rice",
  "rings",
  "rivers",
  "rockets",
  "rocks",
  "rooms",
  "roses",
  "rules",
  "sails",
  "schools",
  "seals",
  "seas",
  "sheep",
  "shirts",
  "shoes",
  "showers",
  "shrimps",
  "sides",
  "signs",
  "singers",
  "sites",
  "sloths",
  "snails",
  "snakes",
  "socks",
  "spiders",
  "spies",
  "spoons",
  "squids",
  "stamps",
  "stars",
  "states",
  "steaks",
  "streets",
  "suits",
  "suns",
  "swans",
  "symbols",
  "tables",
  "taxes",
  "taxis",
  "teams",
  "teeth",
  "terms",
  "things",
  "ties",
  "tigers",
  "times",
  "tips",
  "tires",
  "toes",
  "tools",
  "towns",
  "toys",
  "trains",
  "trams",
  "trees",
  "turkeys",
  "turtles",
  "vans",
  "views",
  "walls",
  "wasps",
  "waves",
  "ways",
  "webs",
  "weeks",
  "windows",
  "wings",
  "wolves",
  "wombats",
  "words",
  "worlds",
  "worms",
  "yaks",
  "years",
  "zebras",
  "zoos",
] as const;

function hashString(value: string): number {
  let hash = 2166136261;
  for (let index = 0; index < value.length; index += 1) {
    hash ^= value.charCodeAt(index);
    hash = Math.imul(hash, 16777619);
  }
  return hash >>> 0;
}

function pickWord(words: readonly string[], hash: number, salt: number): string {
  const mixed = Math.imul(hash ^ salt, 2246822519) >>> 0;
  return words[mixed % words.length] ?? words[0] ?? "visitor";
}

export function formatReadableVisitorId(visitorId: Id<"visitors"> | string): string {
  const value = String(visitorId);
  const hash = hashString(value);
  const adjective = pickWord(HUMAN_ID_ADJECTIVES, hash, 0x9e3779b9);
  const noun = pickWord(HUMAN_ID_NOUNS, hash, 0x85ebca6b);
  const numericSeed = Math.imul(hash ^ 0x27d4eb2d, 0x165667b1) >>> 0;
  const suffix = String((numericSeed % 99) + 1).padStart(2, "0");
  return `${adjective}-${noun}-${suffix}`;
}
